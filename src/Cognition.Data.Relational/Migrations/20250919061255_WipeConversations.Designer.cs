// <auto-generated />
using System;
using System.Collections.Generic;
using Cognition.Data.Relational;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;
using Npgsql.EntityFrameworkCore.PostgreSQL.Metadata;

#nullable disable

namespace Cognition.Data.Relational.Migrations
{
    [DbContext(typeof(CognitionDbContext))]
    [Migration("20250919061255_WipeConversations")]
    partial class WipeConversations
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder
                .HasAnnotation("ProductVersion", "9.0.9")
                .HasAnnotation("Relational:MaxIdentifierLength", 63);

            NpgsqlModelBuilderExtensions.UseIdentityByDefaultColumns(modelBuilder);

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Agents.Agent", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid?>("ClientProfileId")
                        .HasColumnType("uuid")
                        .HasColumnName("client_profile_id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid>("PersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("persona_id");

                    b.Property<string>("Prefix")
                        .HasColumnType("text")
                        .HasColumnName("prefix");

                    b.Property<bool>("RolePlay")
                        .HasColumnType("boolean")
                        .HasColumnName("role_play");

                    b.Property<Dictionary<string, object>>("State")
                        .HasColumnType("jsonb")
                        .HasColumnName("state");

                    b.Property<string>("Suffix")
                        .HasColumnType("text")
                        .HasColumnName("suffix");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<Guid>("Version")
                        .HasColumnType("uuid")
                        .HasColumnName("version");

                    b.HasKey("Id")
                        .HasName("pk_agents");

                    b.HasIndex("ClientProfileId");

                    b.HasIndex("PersonaId")
                        .IsUnique();

                    b.ToTable("agents", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Agents.AgentToolBinding", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid?>("AgentId")
                        .HasColumnType("uuid");

                    b.Property<Dictionary<string, object>>("Config")
                        .HasColumnType("jsonb")
                        .HasColumnName("config");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<bool>("Enabled")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("enabled");

                    b.Property<Guid>("ScopeId")
                        .HasColumnType("uuid")
                        .HasColumnName("scope_id");

                    b.Property<string>("ScopeType")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("scope_type");

                    b.Property<Guid>("ToolId")
                        .HasColumnType("uuid")
                        .HasColumnName("tool_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_agent_tool_bindings");

                    b.HasIndex("AgentId");

                    b.HasIndex("ToolId");

                    b.HasIndex("ScopeType", "ScopeId", "ToolId")
                        .IsUnique()
                        .HasDatabaseName("ux_agent_tool_bindings_scope_tool");

                    b.ToTable("agent_tool_bindings", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Config.DataSource", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("CollectionName")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("collection_name");

                    b.Property<Dictionary<string, object>>("Config")
                        .HasColumnType("jsonb")
                        .HasColumnName("config");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("DataSourceType")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("data_source_type");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("name");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_data_sources");

                    b.HasIndex("Name", "DataSourceType")
                        .IsUnique()
                        .HasDatabaseName("ux_data_sources_name_type");

                    b.ToTable("data_sources", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Config.SystemVariable", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Key")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("key");

                    b.Property<string>("Type")
                        .HasColumnType("text")
                        .HasColumnName("type");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<Dictionary<string, object>>("Value")
                        .HasColumnType("jsonb")
                        .HasColumnName("value");

                    b.HasKey("Id")
                        .HasName("pk_system_variables");

                    b.HasIndex("Key")
                        .IsUnique()
                        .HasDatabaseName("ux_system_variables_key");

                    b.ToTable("system_variables", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.Conversation", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid>("AgentId")
                        .HasColumnType("uuid")
                        .HasColumnName("agent_id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Dictionary<string, object>>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<string>("Title")
                        .HasColumnType("text")
                        .HasColumnName("title");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_conversations");

                    b.HasIndex("AgentId");

                    b.ToTable("conversations", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationMessage", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<int>("ActiveVersionIndex")
                        .HasColumnType("integer")
                        .HasColumnName("active_version_index");

                    b.Property<string>("Content")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("content");

                    b.Property<Guid>("ConversationId")
                        .HasColumnType("uuid")
                        .HasColumnName("conversation_id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid?>("CreatedByUserId")
                        .HasColumnType("uuid")
                        .HasColumnName("created_by_user_id");

                    b.Property<Guid>("FromAgentId")
                        .HasColumnType("uuid")
                        .HasColumnName("from_agent_id");

                    b.Property<Guid>("FromPersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("from_persona_id");

                    b.Property<string>("Metatype")
                        .HasColumnType("text")
                        .HasColumnName("metatype");

                    b.Property<string>("Role")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("role");

                    b.Property<DateTime>("Timestamp")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("timestamp");

                    b.Property<Guid?>("ToPersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("to_persona_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_conversation_messages");

                    b.HasIndex("FromAgentId");

                    b.HasIndex("FromPersonaId");

                    b.HasIndex("ToPersonaId");

                    b.HasIndex("ConversationId", "Timestamp")
                        .HasDatabaseName("ix_conversation_messages_conversation_ts");

                    b.ToTable("conversation_messages", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationMessageVersion", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("Content")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("content");

                    b.Property<Guid>("ConversationMessageId")
                        .HasColumnType("uuid")
                        .HasColumnName("conversation_message_id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone");

                    b.Property<int>("VersionIndex")
                        .HasColumnType("integer")
                        .HasColumnName("version_index");

                    b.HasKey("Id")
                        .HasName("pk_conversation_message_versions");

                    b.HasIndex("ConversationMessageId", "VersionIndex")
                        .IsUnique()
                        .HasDatabaseName("ux_conversation_message_versions_message_index");

                    b.ToTable("conversation_message_versions", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationParticipant", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid>("ConversationId")
                        .HasColumnType("uuid")
                        .HasColumnName("conversation_id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<DateTime>("JoinedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("joined_at_utc");

                    b.Property<Guid>("PersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("persona_id");

                    b.Property<string>("Role")
                        .HasColumnType("text")
                        .HasColumnName("role");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_conversation_participants");

                    b.HasIndex("PersonaId");

                    b.HasIndex("ConversationId", "PersonaId")
                        .HasDatabaseName("ix_conversation_participants_conversation_persona");

                    b.ToTable("conversation_participants", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationPlan", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid>("ConversationId")
                        .HasColumnType("uuid")
                        .HasColumnName("conversation_id");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<string>("OutlineJson")
                        .HasColumnType("jsonb")
                        .HasColumnName("outline_json");

                    b.Property<Guid>("PersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("persona_id");

                    b.Property<string>("Title")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("title");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone");

                    b.HasKey("Id")
                        .HasName("pk_conversation_plans");

                    b.HasIndex("ConversationId");

                    b.HasIndex("PersonaId");

                    b.ToTable("conversation_plans", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationSummary", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid>("ByPersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("by_persona_id");

                    b.Property<string>("Content")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("content");

                    b.Property<Guid>("ConversationId")
                        .HasColumnType("uuid")
                        .HasColumnName("conversation_id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid?>("ReferencesPersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("references_persona_id");

                    b.Property<DateTime>("Timestamp")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("timestamp");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_conversation_summaries");

                    b.HasIndex("ByPersonaId");

                    b.HasIndex("ConversationId");

                    b.HasIndex("ReferencesPersonaId");

                    b.ToTable("conversation_summaries", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationTask", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("ArgsJson")
                        .HasColumnType("jsonb")
                        .HasColumnName("args_json");

                    b.Property<Guid>("ConversationPlanId")
                        .HasColumnType("uuid")
                        .HasColumnName("conversation_plan_id");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("Error")
                        .HasColumnType("text")
                        .HasColumnName("error");

                    b.Property<string>("FinalAnswer")
                        .HasColumnType("text")
                        .HasColumnName("final_answer");

                    b.Property<bool>("Finish")
                        .HasColumnType("boolean")
                        .HasColumnName("finish");

                    b.Property<string>("Goal")
                        .HasColumnType("text")
                        .HasColumnName("goal");

                    b.Property<string>("Observation")
                        .HasColumnType("text")
                        .HasColumnName("observation");

                    b.Property<string>("Rationale")
                        .HasColumnType("text")
                        .HasColumnName("rationale");

                    b.Property<string>("Status")
                        .HasColumnType("text")
                        .HasColumnName("status");

                    b.Property<int>("StepNumber")
                        .HasColumnType("integer")
                        .HasColumnName("step_number");

                    b.Property<string>("Thought")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("thought");

                    b.Property<Guid?>("ToolId")
                        .HasColumnType("uuid")
                        .HasColumnName("tool_id");

                    b.Property<string>("ToolName")
                        .HasColumnType("text")
                        .HasColumnName("tool_name");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone");

                    b.HasKey("Id")
                        .HasName("pk_conversation_tasks");

                    b.HasIndex("ConversationPlanId");

                    b.ToTable("conversation_tasks", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationThought", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid>("ConversationId")
                        .HasColumnType("uuid")
                        .HasColumnName("conversation_id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid?>("ParentThoughtId")
                        .HasColumnType("uuid")
                        .HasColumnName("parent_thought_id");

                    b.Property<Guid>("PersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("persona_id");

                    b.Property<string>("PlanSnapshotJson")
                        .HasColumnType("jsonb")
                        .HasColumnName("plan_snapshot_json");

                    b.Property<string>("Prompt")
                        .HasColumnType("text")
                        .HasColumnName("prompt");

                    b.Property<string>("Rationale")
                        .HasColumnType("text")
                        .HasColumnName("rationale");

                    b.Property<int>("StepNumber")
                        .HasColumnType("integer")
                        .HasColumnName("step_number");

                    b.Property<string>("Thought")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("thought");

                    b.Property<DateTime>("Timestamp")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("timestamp");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone");

                    b.HasKey("Id")
                        .HasName("pk_conversation_thoughts");

                    b.HasIndex("ConversationId");

                    b.HasIndex("PersonaId");

                    b.ToTable("conversation_thoughts", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationWorkflowState", b =>
                {
                    b.Property<Guid>("ConversationId")
                        .HasColumnType("uuid");

                    b.Property<string>("Blackboard")
                        .IsRequired()
                        .HasColumnType("jsonb");

                    b.Property<int>("Pointer")
                        .HasColumnType("integer");

                    b.Property<string>("Stage")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<DateTime>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone");

                    b.HasKey("ConversationId");

                    b.ToTable("conversation_workflow_states");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.WorkflowEvent", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<Guid>("ConversationId")
                        .HasColumnType("uuid");

                    b.Property<string>("Kind")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("Payload")
                        .IsRequired()
                        .HasColumnType("jsonb");

                    b.Property<DateTime>("Timestamp")
                        .HasColumnType("timestamp with time zone");

                    b.HasKey("Id");

                    b.ToTable("workflow_events");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.FeatureFlags.FeatureFlag", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc")
                        .HasDefaultValueSql("CURRENT_TIMESTAMP");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<bool>("IsEnabled")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_enabled");

                    b.Property<string>("Key")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("key");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_feature_flags");

                    b.HasIndex("Key")
                        .IsUnique()
                        .HasDatabaseName("ux_feature_flags_key");

                    b.ToTable("feature_flags", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.Annotation", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Details")
                        .HasColumnType("text")
                        .HasColumnName("details");

                    b.Property<Guid>("FictionProjectId")
                        .HasColumnType("uuid")
                        .HasColumnName("fiction_project_id");

                    b.Property<string>("Message")
                        .HasColumnType("text")
                        .HasColumnName("message");

                    b.Property<bool>("Resolved")
                        .HasColumnType("boolean")
                        .HasColumnName("resolved");

                    b.Property<string>("Severity")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("severity");

                    b.Property<Guid>("TargetId")
                        .HasColumnType("uuid")
                        .HasColumnName("target_id");

                    b.Property<string>("TargetType")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("target_type");

                    b.Property<string>("Type")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("type");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_annotations");

                    b.HasIndex("FictionProjectId", "TargetType", "TargetId")
                        .HasDatabaseName("ix_annotations_target");

                    b.ToTable("annotations", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.CanonRule", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<double>("Confidence")
                        .HasColumnType("double precision")
                        .HasColumnName("confidence");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Evidence")
                        .HasColumnType("text")
                        .HasColumnName("evidence");

                    b.Property<Guid>("FictionProjectId")
                        .HasColumnType("uuid")
                        .HasColumnName("fiction_project_id");

                    b.Property<string>("Key")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("key");

                    b.Property<Guid?>("KnowledgeItemId")
                        .HasColumnType("uuid")
                        .HasColumnName("knowledge_item_id");

                    b.Property<Guid?>("PlotArcId")
                        .HasColumnType("uuid")
                        .HasColumnName("plot_arc_id");

                    b.Property<string>("Scope")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("scope");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<Dictionary<string, object>>("Value")
                        .HasColumnType("jsonb")
                        .HasColumnName("value");

                    b.HasKey("Id")
                        .HasName("pk_canon_rules");

                    b.HasIndex("PlotArcId");

                    b.HasIndex("FictionProjectId", "Key")
                        .HasDatabaseName("ix_canon_rules_project_key");

                    b.ToTable("canon_rules", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.DraftSegment", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<int>("ActiveVersionIndex")
                        .HasColumnType("integer")
                        .HasColumnName("active_version_index");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid>("FictionProjectId")
                        .HasColumnType("uuid")
                        .HasColumnName("fiction_project_id");

                    b.Property<Guid?>("OutlineNodeId")
                        .HasColumnType("uuid")
                        .HasColumnName("outline_node_id");

                    b.Property<string>("Title")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("title");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_draft_segments");

                    b.HasIndex("FictionProjectId");

                    b.HasIndex("OutlineNodeId");

                    b.ToTable("draft_segments", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.DraftSegmentVersion", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("BodyMarkdown")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("body_markdown");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid>("DraftSegmentId")
                        .HasColumnType("uuid")
                        .HasColumnName("draft_segment_id");

                    b.Property<Guid?>("KnowledgeItemId")
                        .HasColumnType("uuid")
                        .HasColumnName("knowledge_item_id");

                    b.Property<Dictionary<string, object>>("Metrics")
                        .HasColumnType("jsonb")
                        .HasColumnName("metrics");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<int>("VersionIndex")
                        .HasColumnType("integer")
                        .HasColumnName("version_index");

                    b.HasKey("Id")
                        .HasName("pk_draft_segment_versions");

                    b.HasIndex("DraftSegmentId", "VersionIndex")
                        .IsUnique()
                        .HasDatabaseName("ux_draft_segment_versions_segment_index");

                    b.ToTable("draft_segment_versions", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.FictionProject", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Logline")
                        .HasColumnType("text")
                        .HasColumnName("logline");

                    b.Property<Guid?>("PrimaryStyleGuideId")
                        .HasColumnType("uuid")
                        .HasColumnName("primary_style_guide_id");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("status");

                    b.Property<string>("Title")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("title");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_fiction_projects");

                    b.HasIndex("PrimaryStyleGuideId");

                    b.ToTable("fiction_projects", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.GlossaryTerm", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.PrimitiveCollection<string[]>("Aliases")
                        .HasColumnType("text[]")
                        .HasColumnName("aliases");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Definition")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("definition");

                    b.Property<string>("Domain")
                        .HasColumnType("text")
                        .HasColumnName("domain");

                    b.Property<Guid>("FictionProjectId")
                        .HasColumnType("uuid")
                        .HasColumnName("fiction_project_id");

                    b.Property<Guid?>("KnowledgeItemId")
                        .HasColumnType("uuid")
                        .HasColumnName("knowledge_item_id");

                    b.Property<string>("Term")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("term");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_glossary_terms");

                    b.HasIndex("FictionProjectId", "Term")
                        .IsUnique()
                        .HasDatabaseName("ux_glossary_terms_project_term");

                    b.ToTable("glossary_terms", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.OutlineNode", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<int>("ActiveVersionIndex")
                        .HasColumnType("integer")
                        .HasColumnName("active_version_index");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid>("FictionProjectId")
                        .HasColumnType("uuid")
                        .HasColumnName("fiction_project_id");

                    b.Property<Guid?>("ParentId")
                        .HasColumnType("uuid")
                        .HasColumnName("parent_id");

                    b.Property<Guid?>("PlotArcId")
                        .HasColumnType("uuid")
                        .HasColumnName("plot_arc_id");

                    b.Property<int>("SequenceIndex")
                        .HasColumnType("integer")
                        .HasColumnName("sequence_index");

                    b.Property<string>("Title")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("title");

                    b.Property<string>("Type")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("type");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_outline_nodes");

                    b.HasIndex("ParentId");

                    b.HasIndex("PlotArcId");

                    b.HasIndex("FictionProjectId", "Type", "SequenceIndex")
                        .HasDatabaseName("ix_outline_nodes_project_type_seq");

                    b.ToTable("outline_nodes", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.OutlineNodeVersion", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Dictionary<string, object>>("Beats")
                        .HasColumnType("jsonb")
                        .HasColumnName("beats");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Goals")
                        .HasColumnType("text")
                        .HasColumnName("goals");

                    b.Property<Guid?>("KnowledgeItemId")
                        .HasColumnType("uuid")
                        .HasColumnName("knowledge_item_id");

                    b.Property<Guid>("OutlineNodeId")
                        .HasColumnType("uuid")
                        .HasColumnName("outline_node_id");

                    b.Property<string>("Pov")
                        .HasColumnType("text")
                        .HasColumnName("pov");

                    b.Property<string>("Status")
                        .HasColumnType("text")
                        .HasColumnName("status");

                    b.Property<string>("Tension")
                        .HasColumnType("text")
                        .HasColumnName("tension");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<int>("VersionIndex")
                        .HasColumnType("integer")
                        .HasColumnName("version_index");

                    b.HasKey("Id")
                        .HasName("pk_outline_node_versions");

                    b.HasIndex("OutlineNodeId", "VersionIndex")
                        .IsUnique()
                        .HasDatabaseName("ux_outline_node_versions_node_index");

                    b.ToTable("outline_node_versions", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.PlotArc", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("Conflict")
                        .HasColumnType("text")
                        .HasColumnName("conflict");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid>("FictionProjectId")
                        .HasColumnType("uuid")
                        .HasColumnName("fiction_project_id");

                    b.Property<string>("Goal")
                        .HasColumnType("text")
                        .HasColumnName("goal");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("name");

                    b.Property<string>("Premise")
                        .HasColumnType("text")
                        .HasColumnName("premise");

                    b.Property<string>("Resolution")
                        .HasColumnType("text")
                        .HasColumnName("resolution");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_plot_arcs");

                    b.HasIndex("FictionProjectId");

                    b.ToTable("plot_arcs", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.Source", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("Citation")
                        .HasColumnType("text")
                        .HasColumnName("citation");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid>("FictionProjectId")
                        .HasColumnType("uuid")
                        .HasColumnName("fiction_project_id");

                    b.Property<DateTime?>("PublishedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("published_at");

                    b.Property<string>("Title")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("title");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<string>("Url")
                        .HasColumnType("text")
                        .HasColumnName("url");

                    b.HasKey("Id")
                        .HasName("pk_sources");

                    b.HasIndex("FictionProjectId");

                    b.ToTable("sources", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.StyleGuide", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid>("FictionProjectId")
                        .HasColumnType("uuid")
                        .HasColumnName("fiction_project_id");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("name");

                    b.Property<Dictionary<string, object>>("Rules")
                        .HasColumnType("jsonb")
                        .HasColumnName("rules");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_style_guides");

                    b.HasIndex("FictionProjectId");

                    b.ToTable("style_guides", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.TimelineEvent", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<Guid>("FictionProjectId")
                        .HasColumnType("uuid")
                        .HasColumnName("fiction_project_id");

                    b.Property<string>("InWorldDate")
                        .HasColumnType("text")
                        .HasColumnName("in_world_date");

                    b.Property<int?>("Index")
                        .HasColumnType("integer")
                        .HasColumnName("index");

                    b.Property<Guid?>("OutlineNodeId")
                        .HasColumnType("uuid")
                        .HasColumnName("outline_node_id");

                    b.Property<string>("Title")
                        .HasColumnType("text")
                        .HasColumnName("title");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_timeline_events");

                    b.HasIndex("FictionProjectId");

                    b.HasIndex("OutlineNodeId");

                    b.ToTable("timeline_events", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.TimelineEventAsset", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid>("TimelineEventId")
                        .HasColumnType("uuid")
                        .HasColumnName("timeline_event_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<Guid>("WorldAssetId")
                        .HasColumnType("uuid")
                        .HasColumnName("world_asset_id");

                    b.HasKey("Id")
                        .HasName("pk_timeline_event_assets");

                    b.HasIndex("WorldAssetId");

                    b.HasIndex("TimelineEventId", "WorldAssetId")
                        .IsUnique()
                        .HasDatabaseName("ux_timeline_event_assets_event_asset");

                    b.ToTable("timeline_event_assets", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.WorldAsset", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<int>("ActiveVersionIndex")
                        .HasColumnType("integer")
                        .HasColumnName("active_version_index");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid>("FictionProjectId")
                        .HasColumnType("uuid")
                        .HasColumnName("fiction_project_id");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("name");

                    b.Property<Guid?>("PersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("persona_id");

                    b.Property<string>("Slug")
                        .HasColumnType("text")
                        .HasColumnName("slug");

                    b.Property<string>("Type")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("type");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_world_assets");

                    b.HasIndex("FictionProjectId", "Type", "Name")
                        .HasDatabaseName("ix_world_assets_project_type_name");

                    b.ToTable("world_assets", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.WorldAssetVersion", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Dictionary<string, object>>("Content")
                        .HasColumnType("jsonb")
                        .HasColumnName("content");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid?>("KnowledgeItemId")
                        .HasColumnType("uuid")
                        .HasColumnName("knowledge_item_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<int>("VersionIndex")
                        .HasColumnType("integer")
                        .HasColumnName("version_index");

                    b.Property<Guid>("WorldAssetId")
                        .HasColumnType("uuid")
                        .HasColumnName("world_asset_id");

                    b.HasKey("Id")
                        .HasName("pk_world_asset_versions");

                    b.HasIndex("WorldAssetId", "VersionIndex")
                        .IsUnique()
                        .HasDatabaseName("ux_world_asset_versions_asset_index");

                    b.ToTable("world_asset_versions", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Images.ImageAsset", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<byte[]>("Bytes")
                        .IsRequired()
                        .HasColumnType("bytea")
                        .HasColumnName("bytes");

                    b.Property<Guid?>("ConversationId")
                        .HasColumnType("uuid")
                        .HasColumnName("conversation_id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid?>("CreatedByPersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("created_by_persona_id");

                    b.Property<float>("Guidance")
                        .HasColumnType("real")
                        .HasColumnName("guidance");

                    b.Property<int>("Height")
                        .HasColumnType("integer")
                        .HasColumnName("height");

                    b.Property<Dictionary<string, object>>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<string>("MimeType")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("mime_type");

                    b.Property<string>("Model")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("model");

                    b.Property<string>("NegativePrompt")
                        .HasColumnType("text")
                        .HasColumnName("negative_prompt");

                    b.Property<string>("Prompt")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("prompt");

                    b.Property<string>("Provider")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("provider");

                    b.Property<int?>("Seed")
                        .HasColumnType("integer")
                        .HasColumnName("seed");

                    b.Property<string>("Sha256")
                        .HasColumnType("text")
                        .HasColumnName("sha256");

                    b.Property<int>("Steps")
                        .HasColumnType("integer")
                        .HasColumnName("steps");

                    b.Property<Guid?>("StyleId")
                        .HasColumnType("uuid")
                        .HasColumnName("style_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<int>("Width")
                        .HasColumnType("integer")
                        .HasColumnName("width");

                    b.HasKey("Id")
                        .HasName("pk_image_assets");

                    b.HasIndex("CreatedByPersonaId");

                    b.HasIndex("Sha256")
                        .HasDatabaseName("ix_image_assets_sha256");

                    b.HasIndex("StyleId");

                    b.HasIndex("ConversationId", "CreatedAtUtc")
                        .HasDatabaseName("ix_image_assets_conversation_time");

                    b.ToTable("image_assets", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Images.ImageStyle", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Dictionary<string, object>>("Defaults")
                        .HasColumnType("jsonb")
                        .HasColumnName("defaults");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<bool>("IsActive")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("is_active");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("name");

                    b.Property<string>("NegativePrompt")
                        .HasColumnType("text")
                        .HasColumnName("negative_prompt");

                    b.Property<string>("PromptPrefix")
                        .HasColumnType("text")
                        .HasColumnName("prompt_prefix");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_image_styles");

                    b.HasIndex("Name")
                        .IsUnique()
                        .HasDatabaseName("ux_image_styles_name");

                    b.ToTable("image_styles", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Instructions.Instruction", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("Content")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("content");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<bool>("IsActive")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("is_active");

                    b.Property<string>("Kind")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("kind");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("name");

                    b.Property<bool>("RolePlay")
                        .HasColumnType("boolean")
                        .HasColumnName("role_play");

                    b.PrimitiveCollection<string[]>("Tags")
                        .HasColumnType("text[]")
                        .HasColumnName("tags");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<string>("Version")
                        .HasColumnType("text")
                        .HasColumnName("version");

                    b.HasKey("Id")
                        .HasName("pk_instructions");

                    b.ToTable("instructions", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Instructions.InstructionSet", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<bool>("IsActive")
                        .HasColumnType("boolean")
                        .HasColumnName("is_active");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("name");

                    b.Property<string>("Scope")
                        .HasColumnType("text")
                        .HasColumnName("scope");

                    b.Property<Guid?>("ScopeRefId")
                        .HasColumnType("uuid")
                        .HasColumnName("scope_ref_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_instruction_sets");

                    b.HasIndex("Name")
                        .HasDatabaseName("ix_instruction_sets_name");

                    b.ToTable("instruction_sets", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Instructions.InstructionSetItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<bool>("Enabled")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("enabled");

                    b.Property<Guid>("InstructionId")
                        .HasColumnType("uuid")
                        .HasColumnName("instruction_id");

                    b.Property<Guid>("InstructionSetId")
                        .HasColumnType("uuid")
                        .HasColumnName("instruction_set_id");

                    b.Property<int>("Order")
                        .HasColumnType("integer")
                        .HasColumnName("order");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_instruction_set_items");

                    b.HasIndex("InstructionId");

                    b.HasIndex("InstructionSetId", "Order")
                        .HasDatabaseName("ix_instruction_set_items_order");

                    b.ToTable("instruction_set_items", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Knowledge.KnowledgeEmbedding", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<int?>("CharEnd")
                        .HasColumnType("integer")
                        .HasColumnName("char_end");

                    b.Property<int?>("CharStart")
                        .HasColumnType("integer")
                        .HasColumnName("char_start");

                    b.Property<int?>("ChunkIndex")
                        .HasColumnType("integer")
                        .HasColumnName("chunk_index");

                    b.Property<string>("ContentHash")
                        .HasColumnType("text")
                        .HasColumnName("content_hash");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<int?>("Dimensions")
                        .HasColumnType("integer")
                        .HasColumnName("dimensions");

                    b.Property<Guid>("KnowledgeItemId")
                        .HasColumnType("uuid")
                        .HasColumnName("knowledge_item_id");

                    b.Property<string>("Label")
                        .HasColumnType("text")
                        .HasColumnName("label");

                    b.Property<string>("Language")
                        .HasColumnType("text")
                        .HasColumnName("language");

                    b.Property<Dictionary<string, object>>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<string>("Model")
                        .HasColumnType("text")
                        .HasColumnName("model");

                    b.Property<string>("ModelVersion")
                        .HasColumnType("text")
                        .HasColumnName("model_version");

                    b.Property<bool?>("Normalized")
                        .HasColumnType("boolean")
                        .HasColumnName("normalized");

                    b.Property<string>("Provider")
                        .HasColumnType("text")
                        .HasColumnName("provider");

                    b.Property<int?>("SchemaVersion")
                        .HasColumnType("integer")
                        .HasColumnName("schema_version");

                    b.Property<string>("Space")
                        .HasColumnType("text")
                        .HasColumnName("space");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.PrimitiveCollection<float[]>("Vector")
                        .IsRequired()
                        .HasColumnType("real[]")
                        .HasColumnName("vector");

                    b.Property<double?>("VectorL2Norm")
                        .HasColumnType("double precision")
                        .HasColumnName("vector_l2_norm");

                    b.HasKey("Id")
                        .HasName("pk_knowledge_embeddings");

                    b.HasIndex("Dimensions")
                        .HasDatabaseName("ix_knowledge_embeddings_dimensions");

                    b.HasIndex("KnowledgeItemId")
                        .HasDatabaseName("ix_knowledge_embeddings_item_id");

                    b.HasIndex("Model")
                        .HasDatabaseName("ix_knowledge_embeddings_model");

                    b.HasIndex("Provider")
                        .HasDatabaseName("ix_knowledge_embeddings_provider");

                    b.HasIndex("KnowledgeItemId", "Model", "ModelVersion", "ChunkIndex")
                        .IsUnique()
                        .HasDatabaseName("ux_knowledge_embeddings_item_model_version_chunk");

                    b.ToTable("knowledge_embeddings", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Knowledge.KnowledgeItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.PrimitiveCollection<string[]>("Categories")
                        .HasColumnType("text[]")
                        .HasColumnName("categories");

                    b.Property<string>("Content")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("content");

                    b.Property<string>("ContentType")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("content_type");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.PrimitiveCollection<string[]>("Keywords")
                        .HasColumnType("text[]")
                        .HasColumnName("keywords");

                    b.Property<Dictionary<string, object>>("Properties")
                        .HasColumnType("jsonb")
                        .HasColumnName("properties");

                    b.Property<string>("Source")
                        .HasColumnType("text")
                        .HasColumnName("source");

                    b.Property<DateTime>("Timestamp")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("timestamp");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_knowledge_items");

                    b.HasIndex("Timestamp")
                        .HasDatabaseName("ix_knowledge_items_timestamp");

                    b.ToTable("knowledge_items", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Knowledge.KnowledgeRelation", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<Guid>("FromKnowledgeItemId")
                        .HasColumnType("uuid")
                        .HasColumnName("from_item_id");

                    b.Property<string>("RelationshipType")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("relationship_type");

                    b.Property<Guid>("ToKnowledgeItemId")
                        .HasColumnType("uuid")
                        .HasColumnName("to_item_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<double>("Weight")
                        .HasColumnType("double precision")
                        .HasColumnName("weight");

                    b.HasKey("Id")
                        .HasName("pk_knowledge_relations");

                    b.HasIndex("ToKnowledgeItemId");

                    b.HasIndex("FromKnowledgeItemId", "ToKnowledgeItemId")
                        .HasDatabaseName("ix_knowledge_relations_pair");

                    b.ToTable("knowledge_relations", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.LLM.ApiCredential", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<bool>("IsValid")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("is_valid");

                    b.Property<string>("KeyRef")
                        .IsRequired()
                        .HasMaxLength(256)
                        .HasColumnType("character varying(256)")
                        .HasColumnName("key_ref");

                    b.Property<DateTime?>("LastUsedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_used_at_utc");

                    b.Property<string>("Notes")
                        .HasColumnType("text")
                        .HasColumnName("notes");

                    b.Property<Guid>("ProviderId")
                        .HasColumnType("uuid")
                        .HasColumnName("provider_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_api_credentials");

                    b.HasIndex("ProviderId", "KeyRef")
                        .IsUnique()
                        .HasDatabaseName("ux_api_credentials_provider_keyref");

                    b.ToTable("api_credentials", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.LLM.ClientProfile", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid?>("ApiCredentialId")
                        .HasColumnType("uuid")
                        .HasColumnName("api_credential_id");

                    b.Property<string>("BaseUrlOverride")
                        .HasColumnType("text")
                        .HasColumnName("base_url_override");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<double>("FrequencyPenalty")
                        .HasColumnType("double precision")
                        .HasColumnName("frequency_penalty");

                    b.Property<bool>("IsActive")
                        .HasColumnType("boolean");

                    b.Property<bool>("LoggingEnabled")
                        .HasColumnType("boolean")
                        .HasColumnName("logging_enabled");

                    b.Property<int>("MaxTokens")
                        .HasColumnType("integer")
                        .HasColumnName("max_tokens");

                    b.Property<Guid?>("ModelId")
                        .HasColumnType("uuid")
                        .HasColumnName("model_id");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("name");

                    b.Property<double>("PresencePenalty")
                        .HasColumnType("double precision")
                        .HasColumnName("presence_penalty");

                    b.Property<Guid>("ProviderId")
                        .HasColumnType("uuid")
                        .HasColumnName("provider_id");

                    b.Property<bool>("Stream")
                        .HasColumnType("boolean")
                        .HasColumnName("stream");

                    b.Property<double>("Temperature")
                        .HasColumnType("double precision")
                        .HasColumnName("temperature");

                    b.Property<double>("TopP")
                        .HasColumnType("double precision")
                        .HasColumnName("top_p");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<string>("UserName")
                        .HasColumnType("text")
                        .HasColumnName("user_name");

                    b.HasKey("Id")
                        .HasName("pk_client_profiles");

                    b.HasIndex("ApiCredentialId");

                    b.HasIndex("ModelId");

                    b.HasIndex("Name")
                        .HasDatabaseName("ix_client_profiles_name");

                    b.HasIndex("ProviderId");

                    b.ToTable("client_profiles", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.LLM.Model", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<double?>("CachedInputCostPer1M")
                        .HasColumnType("double precision")
                        .HasColumnName("cached_input_cost_per_1m");

                    b.Property<int?>("ContextWindow")
                        .HasColumnType("integer")
                        .HasColumnName("context_window");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("DisplayName")
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<double?>("InputCostPer1M")
                        .HasColumnType("double precision")
                        .HasColumnName("input_cost_per_1m");

                    b.Property<bool>("IsDeprecated")
                        .HasColumnType("boolean")
                        .HasColumnName("is_deprecated");

                    b.Property<Dictionary<string, object>>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("name");

                    b.Property<double?>("OutputCostPer1M")
                        .HasColumnType("double precision")
                        .HasColumnName("output_cost_per_1m");

                    b.Property<Guid>("ProviderId")
                        .HasColumnType("uuid")
                        .HasColumnName("provider_id");

                    b.Property<bool>("SupportsStreaming")
                        .HasColumnType("boolean")
                        .HasColumnName("supports_streaming");

                    b.Property<bool>("SupportsVision")
                        .HasColumnType("boolean")
                        .HasColumnName("supports_vision");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_models");

                    b.HasIndex("ProviderId", "Name")
                        .IsUnique()
                        .HasDatabaseName("ux_models_provider_name");

                    b.ToTable("models", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.LLM.Provider", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("BaseUrl")
                        .HasColumnType("text")
                        .HasColumnName("base_url");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("DisplayName")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<bool>("IsActive")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("is_active");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(64)
                        .HasColumnType("character varying(64)")
                        .HasColumnName("name");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_providers");

                    b.HasIndex("Name")
                        .IsUnique()
                        .HasDatabaseName("ux_providers_name");

                    b.ToTable("providers", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.Persona", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("Background")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("background");

                    b.Property<string>("Beliefs")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("beliefs");

                    b.Property<string>("CommunicationStyle")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("communication_style");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.PrimitiveCollection<string[]>("DomainExpertise")
                        .HasColumnType("text[]")
                        .HasColumnName("domain_expertise");

                    b.Property<string>("EmotionalDrivers")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("emotional_drivers");

                    b.Property<string>("Essence")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("essence");

                    b.Property<string>("Gender")
                        .IsRequired()
                        .HasMaxLength(64)
                        .HasColumnType("character varying(64)")
                        .HasColumnName("gender");

                    b.Property<bool>("IsPublic")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_public");

                    b.PrimitiveCollection<Guid[]>("KnownPersonas")
                        .HasColumnType("uuid[]")
                        .HasColumnName("known_personas");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("name");

                    b.PrimitiveCollection<string[]>("NarrativeThemes")
                        .HasColumnType("text[]")
                        .HasColumnName("narrative_themes");

                    b.Property<string>("Nickname")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("nickname");

                    b.Property<string>("OwnedBy")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("owned_by");

                    b.Property<string>("Role")
                        .IsRequired()
                        .HasMaxLength(256)
                        .HasColumnType("character varying(256)")
                        .HasColumnName("role");

                    b.PrimitiveCollection<string[]>("SignatureTraits")
                        .HasColumnType("text[]")
                        .HasColumnName("signature_traits");

                    b.Property<string>("Type")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("persona_type");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<string>("Voice")
                        .IsRequired()
                        .HasMaxLength(256)
                        .HasColumnType("character varying(256)")
                        .HasColumnName("voice");

                    b.HasKey("Id")
                        .HasName("pk_personas");

                    b.ToTable("personas", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.PersonaDream", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("Content")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("content");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<bool>("Lucid")
                        .HasColumnType("boolean")
                        .HasColumnName("lucid");

                    b.Property<DateTime>("OccurredAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("occurred_at_utc");

                    b.Property<Guid>("PersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("persona_id");

                    b.Property<Dictionary<string, object>>("Properties")
                        .HasColumnType("jsonb")
                        .HasColumnName("properties");

                    b.PrimitiveCollection<string[]>("Tags")
                        .HasColumnType("text[]")
                        .HasColumnName("tags");

                    b.Property<string>("Title")
                        .HasColumnType("text")
                        .HasColumnName("title");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<int>("Valence")
                        .HasColumnType("integer")
                        .HasColumnName("valence");

                    b.Property<int>("Vividness")
                        .HasColumnType("integer")
                        .HasColumnName("vividness");

                    b.HasKey("Id")
                        .HasName("pk_persona_dreams");

                    b.HasIndex("PersonaId", "OccurredAtUtc")
                        .HasDatabaseName("ix_persona_dreams_timeline");

                    b.ToTable("persona_dreams", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.PersonaEvent", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.PrimitiveCollection<string[]>("Categories")
                        .HasColumnType("text[]")
                        .HasColumnName("categories");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<DateTime?>("EndedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("ended_at_utc");

                    b.Property<double?>("Importance")
                        .HasColumnType("double precision")
                        .HasColumnName("importance");

                    b.Property<string>("Location")
                        .HasColumnType("text")
                        .HasColumnName("location");

                    b.Property<Guid>("PersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("persona_id");

                    b.Property<Dictionary<string, object>>("Properties")
                        .HasColumnType("jsonb")
                        .HasColumnName("properties");

                    b.Property<DateTime>("StartedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("started_at_utc");

                    b.PrimitiveCollection<string[]>("Tags")
                        .HasColumnType("text[]")
                        .HasColumnName("tags");

                    b.Property<string>("Title")
                        .IsRequired()
                        .HasMaxLength(256)
                        .HasColumnType("character varying(256)")
                        .HasColumnName("title");

                    b.Property<Guid?>("TypeId")
                        .HasColumnType("uuid")
                        .HasColumnName("type_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_persona_events");

                    b.HasIndex("TypeId");

                    b.HasIndex("PersonaId", "StartedAtUtc")
                        .HasDatabaseName("ix_persona_events_timeline");

                    b.ToTable("persona_events", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.PersonaEventType", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("Category")
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("category");

                    b.Property<string>("Code")
                        .IsRequired()
                        .HasMaxLength(64)
                        .HasColumnType("character varying(64)")
                        .HasColumnName("code");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("name");

                    b.Property<Dictionary<string, object>>("Properties")
                        .HasColumnType("jsonb")
                        .HasColumnName("properties");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_persona_event_types");

                    b.HasIndex("Code")
                        .IsUnique()
                        .HasDatabaseName("ux_persona_event_types_code");

                    b.ToTable("persona_event_types", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.PersonaLink", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<Guid>("FromPersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("from_persona_id");

                    b.Property<string>("RelationshipType")
                        .HasColumnType("text")
                        .HasColumnName("relationship_type");

                    b.Property<Guid>("ToPersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("to_persona_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone");

                    b.Property<double>("Weight")
                        .HasColumnType("double precision")
                        .HasColumnName("weight");

                    b.HasKey("Id")
                        .HasName("pk_persona_links");

                    b.HasIndex("ToPersonaId");

                    b.HasIndex("FromPersonaId", "ToPersonaId")
                        .HasDatabaseName("ix_persona_links_pair");

                    b.ToTable("persona_links", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.PersonaMemory", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("Content")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("content");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.PrimitiveCollection<string[]>("Emotions")
                        .HasColumnType("text[]")
                        .HasColumnName("emotions");

                    b.Property<DateTime?>("ExpiresAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("expires_at_utc");

                    b.Property<double?>("Importance")
                        .HasColumnType("double precision")
                        .HasColumnName("importance");

                    b.Property<DateTime?>("OccurredAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("occurred_at_utc");

                    b.Property<Guid>("PersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("persona_id");

                    b.Property<Dictionary<string, object>>("Properties")
                        .HasColumnType("jsonb")
                        .HasColumnName("properties");

                    b.Property<DateTime>("RecordedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("recorded_at_utc");

                    b.Property<string>("Source")
                        .HasColumnType("text")
                        .HasColumnName("source");

                    b.PrimitiveCollection<string[]>("Tags")
                        .HasColumnType("text[]")
                        .HasColumnName("tags");

                    b.Property<string>("Title")
                        .HasColumnType("text")
                        .HasColumnName("title");

                    b.Property<Guid?>("TypeId")
                        .HasColumnType("uuid")
                        .HasColumnName("type_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_persona_memories");

                    b.HasIndex("TypeId");

                    b.HasIndex("PersonaId", "OccurredAtUtc")
                        .HasDatabaseName("ix_persona_memories_timeline");

                    b.ToTable("persona_memories", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.PersonaMemoryType", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("Category")
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("category");

                    b.Property<string>("Code")
                        .IsRequired()
                        .HasMaxLength(64)
                        .HasColumnType("character varying(64)")
                        .HasColumnName("code");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("name");

                    b.Property<Dictionary<string, object>>("Properties")
                        .HasColumnType("jsonb")
                        .HasColumnName("properties");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_persona_memory_types");

                    b.HasIndex("Code")
                        .IsUnique()
                        .HasDatabaseName("ux_persona_memory_types_code");

                    b.ToTable("persona_memory_types", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.PersonaPersonas", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("FromPersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("from_persona_id");

                    b.Property<bool>("IsOwner")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_owner");

                    b.Property<string>("Label")
                        .HasColumnType("text")
                        .HasColumnName("label");

                    b.Property<Guid>("ToPersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("to_persona_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone");

                    b.HasKey("Id")
                        .HasName("pk_persona_personas");

                    b.HasIndex("ToPersonaId");

                    b.HasIndex("FromPersonaId", "ToPersonaId")
                        .IsUnique()
                        .HasDatabaseName("ux_persona_personas_pair");

                    b.ToTable("persona_personas", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Prompts.PromptTemplate", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Example")
                        .HasColumnType("text")
                        .HasColumnName("example");

                    b.Property<bool>("IsActive")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("is_active");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("name");

                    b.Property<string>("PromptType")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("prompt_type");

                    b.Property<string>("Template")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("template");

                    b.Property<Dictionary<string, object>>("Tokens")
                        .HasColumnType("jsonb")
                        .HasColumnName("tokens");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_prompt_templates");

                    b.ToTable("prompt_templates", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Questions.Question", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid>("CategoryId")
                        .HasColumnType("uuid")
                        .HasColumnName("category_id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<int?>("Difficulty")
                        .HasColumnType("integer")
                        .HasColumnName("difficulty");

                    b.PrimitiveCollection<string[]>("Tags")
                        .HasColumnType("text[]")
                        .HasColumnName("tags");

                    b.Property<string>("Text")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("text");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_questions");

                    b.HasIndex("CategoryId")
                        .HasDatabaseName("ix_questions_category");

                    b.ToTable("questions", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Questions.QuestionCategory", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<string>("Key")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("key");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("name");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_question_categories");

                    b.HasIndex("Key")
                        .IsUnique()
                        .HasDatabaseName("ux_question_categories_key");

                    b.ToTable("question_categories", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Tools.Tool", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("ClassPath")
                        .IsRequired()
                        .HasMaxLength(256)
                        .HasColumnType("character varying(256)")
                        .HasColumnName("class_path");

                    b.Property<Guid?>("ClientProfileId")
                        .HasColumnType("uuid")
                        .HasColumnName("client_profile_id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<string>("Example")
                        .HasColumnType("text")
                        .HasColumnName("example");

                    b.Property<bool>("IsActive")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("is_active");

                    b.Property<Dictionary<string, object>>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("name");

                    b.PrimitiveCollection<string[]>("Tags")
                        .HasColumnType("text[]")
                        .HasColumnName("tags");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_tools");

                    b.HasIndex("ClientProfileId");

                    b.HasIndex("Name")
                        .IsUnique()
                        .HasDatabaseName("ux_tools_name");

                    b.ToTable("tools", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Tools.ToolExecutionLog", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid?>("AgentId")
                        .HasColumnType("uuid")
                        .HasColumnName("agent_id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<int>("DurationMs")
                        .HasColumnType("integer")
                        .HasColumnName("duration_ms");

                    b.Property<string>("Error")
                        .HasColumnType("text")
                        .HasColumnName("error");

                    b.Property<Dictionary<string, object>>("Request")
                        .HasColumnType("jsonb")
                        .HasColumnName("request");

                    b.Property<Dictionary<string, object>>("Response")
                        .HasColumnType("jsonb")
                        .HasColumnName("response");

                    b.Property<DateTime>("StartedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("started_at_utc");

                    b.Property<bool>("Success")
                        .HasColumnType("boolean")
                        .HasColumnName("success");

                    b.Property<Guid>("ToolId")
                        .HasColumnType("uuid")
                        .HasColumnName("tool_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_tool_execution_logs");

                    b.HasIndex("AgentId");

                    b.HasIndex("ToolId", "StartedAtUtc")
                        .HasDatabaseName("ix_tool_execution_logs_tool_time");

                    b.ToTable("tool_execution_logs", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Tools.ToolParameter", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Dictionary<string, object>>("DefaultValue")
                        .HasColumnType("jsonb")
                        .HasColumnName("default_value");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<string>("Direction")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("direction");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("name");

                    b.Property<Dictionary<string, object>>("Options")
                        .HasColumnType("jsonb")
                        .HasColumnName("options");

                    b.Property<bool>("Required")
                        .HasColumnType("boolean")
                        .HasColumnName("required");

                    b.Property<Guid>("ToolId")
                        .HasColumnType("uuid")
                        .HasColumnName("tool_id");

                    b.Property<string>("Type")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("type");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_tool_parameters");

                    b.HasIndex("ToolId", "Name", "Direction")
                        .IsUnique()
                        .HasDatabaseName("ux_tool_parameters_tool_name_dir");

                    b.ToTable("tool_parameters", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Tools.ToolProviderSupport", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<Guid?>("ModelId")
                        .HasColumnType("uuid")
                        .HasColumnName("model_id");

                    b.Property<string>("Notes")
                        .HasColumnType("text")
                        .HasColumnName("notes");

                    b.Property<Guid>("ProviderId")
                        .HasColumnType("uuid")
                        .HasColumnName("provider_id");

                    b.Property<string>("SupportLevel")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("support_level");

                    b.Property<Guid>("ToolId")
                        .HasColumnType("uuid")
                        .HasColumnName("tool_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.HasKey("Id")
                        .HasName("pk_tool_provider_supports");

                    b.HasIndex("ModelId");

                    b.HasIndex("ProviderId");

                    b.HasIndex("ToolId", "ProviderId", "ModelId")
                        .IsUnique()
                        .HasDatabaseName("ux_tool_provider_support_key");

                    b.ToTable("tool_provider_supports", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Users.RefreshToken", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<DateTime>("ExpiresAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("expires_at_utc");

                    b.Property<DateTime?>("RevokedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("revoked_at_utc");

                    b.Property<string>("Token")
                        .IsRequired()
                        .HasMaxLength(512)
                        .HasColumnType("character varying(512)")
                        .HasColumnName("token");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid")
                        .HasColumnName("user_id");

                    b.HasKey("Id")
                        .HasName("pk_refresh_tokens");

                    b.HasIndex("UserId", "Token")
                        .IsUnique()
                        .HasDatabaseName("ux_refresh_tokens_user_token");

                    b.ToTable("refresh_tokens", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Users.User", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<string>("Email")
                        .HasMaxLength(256)
                        .HasColumnType("character varying(256)")
                        .HasColumnName("email");

                    b.Property<bool>("EmailConfirmed")
                        .HasColumnType("boolean")
                        .HasColumnName("email_confirmed");

                    b.Property<bool>("IsActive")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("is_active");

                    b.Property<string>("NormalizedEmail")
                        .HasMaxLength(256)
                        .HasColumnType("character varying(256)")
                        .HasColumnName("normalized_email");

                    b.Property<string>("NormalizedUsername")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("normalized_username");

                    b.Property<string>("PasswordAlgo")
                        .IsRequired()
                        .HasMaxLength(64)
                        .HasColumnType("character varying(64)")
                        .HasColumnName("password_algo");

                    b.Property<byte[]>("PasswordHash")
                        .IsRequired()
                        .HasColumnType("bytea")
                        .HasColumnName("password_hash");

                    b.Property<int>("PasswordHashVersion")
                        .HasColumnType("integer")
                        .HasColumnName("password_hash_version");

                    b.Property<byte[]>("PasswordSalt")
                        .IsRequired()
                        .HasColumnType("bytea")
                        .HasColumnName("password_salt");

                    b.Property<DateTime?>("PasswordUpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("password_updated_at_utc");

                    b.Property<Guid?>("PrimaryPersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("primary_persona_id");

                    b.Property<string>("Role")
                        .IsRequired()
                        .HasMaxLength(32)
                        .HasColumnType("character varying(32)")
                        .HasColumnName("role");

                    b.Property<string>("SecurityStamp")
                        .HasMaxLength(64)
                        .HasColumnType("character varying(64)")
                        .HasColumnName("security_stamp");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<string>("Username")
                        .IsRequired()
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("username");

                    b.HasKey("Id")
                        .HasName("pk_users");

                    b.HasIndex("NormalizedEmail")
                        .IsUnique()
                        .HasDatabaseName("ux_users_normalized_email");

                    b.HasIndex("NormalizedUsername")
                        .IsUnique()
                        .HasDatabaseName("ux_users_normalized_username");

                    b.HasIndex("PrimaryPersonaId");

                    b.ToTable("users", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Users.UserPersonas", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at_utc");

                    b.Property<bool>("IsDefault")
                        .HasColumnType("boolean")
                        .HasColumnName("is_default");

                    b.Property<bool>("IsOwner")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_owner");

                    b.Property<string>("Label")
                        .HasColumnType("text")
                        .HasColumnName("label");

                    b.Property<Guid>("PersonaId")
                        .HasColumnType("uuid")
                        .HasColumnName("persona_id");

                    b.Property<DateTime?>("UpdatedAtUtc")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at_utc");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid")
                        .HasColumnName("user_id");

                    b.HasKey("Id")
                        .HasName("pk_user_personas");

                    b.HasIndex("PersonaId")
                        .HasDatabaseName("IX_user_personas_persona_id");

                    b.HasIndex("UserId", "PersonaId")
                        .IsUnique()
                        .HasDatabaseName("ux_user_personas_user_persona");

                    b.ToTable("user_personas", (string)null);
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Agents.Agent", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.LLM.ClientProfile", "ClientProfile")
                        .WithMany()
                        .HasForeignKey("ClientProfileId")
                        .HasConstraintName("fk_agents_client_profiles");

                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "Persona")
                        .WithMany()
                        .HasForeignKey("PersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_agents_personas");

                    b.Navigation("ClientProfile");

                    b.Navigation("Persona");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Agents.AgentToolBinding", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Agents.Agent", null)
                        .WithMany("ToolBindings")
                        .HasForeignKey("AgentId");

                    b.HasOne("Cognition.Data.Relational.Modules.Tools.Tool", "Tool")
                        .WithMany()
                        .HasForeignKey("ToolId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_agent_tool_bindings_tools");

                    b.Navigation("Tool");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.Conversation", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Agents.Agent", "Agent")
                        .WithMany()
                        .HasForeignKey("AgentId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversations_agents");

                    b.Navigation("Agent");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationMessage", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Conversations.Conversation", "Conversation")
                        .WithMany("Messages")
                        .HasForeignKey("ConversationId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversation_messages_conversations");

                    b.HasOne("Cognition.Data.Relational.Modules.Agents.Agent", "FromAgent")
                        .WithMany()
                        .HasForeignKey("FromAgentId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversation_messages_from_agent");

                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "FromPersona")
                        .WithMany()
                        .HasForeignKey("FromPersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversation_messages_from_persona");

                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "ToPersona")
                        .WithMany()
                        .HasForeignKey("ToPersonaId")
                        .HasConstraintName("fk_conversation_messages_to_persona");

                    b.Navigation("Conversation");

                    b.Navigation("FromAgent");

                    b.Navigation("FromPersona");

                    b.Navigation("ToPersona");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationMessageVersion", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Conversations.ConversationMessage", "ConversationMessage")
                        .WithMany()
                        .HasForeignKey("ConversationMessageId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversation_message_versions_message");

                    b.Navigation("ConversationMessage");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationParticipant", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Conversations.Conversation", "Conversation")
                        .WithMany("Participants")
                        .HasForeignKey("ConversationId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversation_participants_conversations");

                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "Persona")
                        .WithMany()
                        .HasForeignKey("PersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversation_participants_personas");

                    b.Navigation("Conversation");

                    b.Navigation("Persona");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationPlan", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Conversations.Conversation", "Conversation")
                        .WithMany()
                        .HasForeignKey("ConversationId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversation_plans_conversations");

                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "Persona")
                        .WithMany()
                        .HasForeignKey("PersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversation_plans_persona");

                    b.Navigation("Conversation");

                    b.Navigation("Persona");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationSummary", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "ByPersona")
                        .WithMany()
                        .HasForeignKey("ByPersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversation_summaries_by_persona");

                    b.HasOne("Cognition.Data.Relational.Modules.Conversations.Conversation", "Conversation")
                        .WithMany("Summaries")
                        .HasForeignKey("ConversationId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversation_summaries_conversations");

                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "ReferencesPersona")
                        .WithMany()
                        .HasForeignKey("ReferencesPersonaId")
                        .HasConstraintName("fk_conversation_summaries_ref_persona");

                    b.Navigation("ByPersona");

                    b.Navigation("Conversation");

                    b.Navigation("ReferencesPersona");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationTask", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Conversations.ConversationPlan", "ConversationPlan")
                        .WithMany("Tasks")
                        .HasForeignKey("ConversationPlanId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversation_tasks_plan");

                    b.Navigation("ConversationPlan");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationThought", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Conversations.Conversation", "Conversation")
                        .WithMany()
                        .HasForeignKey("ConversationId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversation_thoughts_conversations");

                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "Persona")
                        .WithMany()
                        .HasForeignKey("PersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_conversation_thoughts_persona");

                    b.Navigation("Conversation");

                    b.Navigation("Persona");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationWorkflowState", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Conversations.Conversation", "Conversation")
                        .WithMany()
                        .HasForeignKey("ConversationId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Conversation");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.Annotation", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.FictionProject", "FictionProject")
                        .WithMany()
                        .HasForeignKey("FictionProjectId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_annotations_project");

                    b.Navigation("FictionProject");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.CanonRule", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.FictionProject", "FictionProject")
                        .WithMany()
                        .HasForeignKey("FictionProjectId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_canon_rules_project");

                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.PlotArc", "PlotArc")
                        .WithMany()
                        .HasForeignKey("PlotArcId")
                        .HasConstraintName("fk_canon_rules_plot_arc");

                    b.Navigation("FictionProject");

                    b.Navigation("PlotArc");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.DraftSegment", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.FictionProject", "FictionProject")
                        .WithMany()
                        .HasForeignKey("FictionProjectId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_draft_segments_project");

                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.OutlineNode", "OutlineNode")
                        .WithMany()
                        .HasForeignKey("OutlineNodeId")
                        .HasConstraintName("fk_draft_segments_outline_node");

                    b.Navigation("FictionProject");

                    b.Navigation("OutlineNode");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.DraftSegmentVersion", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.DraftSegment", "DraftSegment")
                        .WithMany("Versions")
                        .HasForeignKey("DraftSegmentId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_draft_segment_versions_segment");

                    b.Navigation("DraftSegment");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.FictionProject", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.StyleGuide", "PrimaryStyleGuide")
                        .WithMany()
                        .HasForeignKey("PrimaryStyleGuideId")
                        .HasConstraintName("fk_fiction_projects_primary_style_guide");

                    b.Navigation("PrimaryStyleGuide");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.GlossaryTerm", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.FictionProject", "FictionProject")
                        .WithMany("GlossaryTerms")
                        .HasForeignKey("FictionProjectId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_glossary_terms_project");

                    b.Navigation("FictionProject");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.OutlineNode", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.FictionProject", "FictionProject")
                        .WithMany()
                        .HasForeignKey("FictionProjectId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_outline_nodes_project");

                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.OutlineNode", "Parent")
                        .WithMany("Children")
                        .HasForeignKey("ParentId")
                        .HasConstraintName("fk_outline_nodes_parent");

                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.PlotArc", "PlotArc")
                        .WithMany("OutlineNodes")
                        .HasForeignKey("PlotArcId")
                        .HasConstraintName("fk_outline_nodes_plot_arc");

                    b.Navigation("FictionProject");

                    b.Navigation("Parent");

                    b.Navigation("PlotArc");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.OutlineNodeVersion", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.OutlineNode", "OutlineNode")
                        .WithMany("Versions")
                        .HasForeignKey("OutlineNodeId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_outline_node_versions_node");

                    b.Navigation("OutlineNode");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.PlotArc", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.FictionProject", "FictionProject")
                        .WithMany("PlotArcs")
                        .HasForeignKey("FictionProjectId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_plot_arcs_project");

                    b.Navigation("FictionProject");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.Source", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.FictionProject", "FictionProject")
                        .WithMany()
                        .HasForeignKey("FictionProjectId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_sources_project");

                    b.Navigation("FictionProject");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.StyleGuide", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.FictionProject", "FictionProject")
                        .WithMany("StyleGuides")
                        .HasForeignKey("FictionProjectId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_style_guides_project");

                    b.Navigation("FictionProject");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.TimelineEvent", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.FictionProject", "FictionProject")
                        .WithMany()
                        .HasForeignKey("FictionProjectId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_timeline_events_project");

                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.OutlineNode", "OutlineNode")
                        .WithMany()
                        .HasForeignKey("OutlineNodeId")
                        .HasConstraintName("fk_timeline_events_outline_node");

                    b.Navigation("FictionProject");

                    b.Navigation("OutlineNode");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.TimelineEventAsset", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.TimelineEvent", "TimelineEvent")
                        .WithMany("Assets")
                        .HasForeignKey("TimelineEventId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_timeline_event_assets_event");

                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.WorldAsset", "WorldAsset")
                        .WithMany()
                        .HasForeignKey("WorldAssetId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_timeline_event_assets_asset");

                    b.Navigation("TimelineEvent");

                    b.Navigation("WorldAsset");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.WorldAsset", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.FictionProject", "FictionProject")
                        .WithMany("WorldAssets")
                        .HasForeignKey("FictionProjectId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_world_assets_project");

                    b.Navigation("FictionProject");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.WorldAssetVersion", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Fiction.WorldAsset", "WorldAsset")
                        .WithMany("Versions")
                        .HasForeignKey("WorldAssetId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_world_asset_versions_asset");

                    b.Navigation("WorldAsset");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Images.ImageAsset", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Conversations.Conversation", "Conversation")
                        .WithMany()
                        .HasForeignKey("ConversationId")
                        .HasConstraintName("fk_image_assets_conversations");

                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "CreatedByPersona")
                        .WithMany()
                        .HasForeignKey("CreatedByPersonaId")
                        .HasConstraintName("fk_image_assets_personas");

                    b.HasOne("Cognition.Data.Relational.Modules.Images.ImageStyle", "Style")
                        .WithMany()
                        .HasForeignKey("StyleId")
                        .HasConstraintName("fk_image_assets_styles");

                    b.Navigation("Conversation");

                    b.Navigation("CreatedByPersona");

                    b.Navigation("Style");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Instructions.InstructionSetItem", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Instructions.Instruction", "Instruction")
                        .WithMany("InstructionSetItems")
                        .HasForeignKey("InstructionId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_instruction_set_items_instructions");

                    b.HasOne("Cognition.Data.Relational.Modules.Instructions.InstructionSet", "InstructionSet")
                        .WithMany("Items")
                        .HasForeignKey("InstructionSetId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_instruction_set_items_sets");

                    b.Navigation("Instruction");

                    b.Navigation("InstructionSet");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Knowledge.KnowledgeEmbedding", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Knowledge.KnowledgeItem", "KnowledgeItem")
                        .WithMany("Embeddings")
                        .HasForeignKey("KnowledgeItemId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_knowledge_embeddings_item");

                    b.Navigation("KnowledgeItem");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Knowledge.KnowledgeRelation", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Knowledge.KnowledgeItem", "FromKnowledgeItem")
                        .WithMany()
                        .HasForeignKey("FromKnowledgeItemId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_knowledge_relations_from");

                    b.HasOne("Cognition.Data.Relational.Modules.Knowledge.KnowledgeItem", "ToKnowledgeItem")
                        .WithMany()
                        .HasForeignKey("ToKnowledgeItemId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_knowledge_relations_to");

                    b.Navigation("FromKnowledgeItem");

                    b.Navigation("ToKnowledgeItem");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.LLM.ApiCredential", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.LLM.Provider", "Provider")
                        .WithMany()
                        .HasForeignKey("ProviderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_api_credentials_providers");

                    b.Navigation("Provider");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.LLM.ClientProfile", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.LLM.ApiCredential", "ApiCredential")
                        .WithMany()
                        .HasForeignKey("ApiCredentialId")
                        .HasConstraintName("fk_client_profiles_api_credentials");

                    b.HasOne("Cognition.Data.Relational.Modules.LLM.Model", "Model")
                        .WithMany()
                        .HasForeignKey("ModelId")
                        .HasConstraintName("fk_client_profiles_models");

                    b.HasOne("Cognition.Data.Relational.Modules.LLM.Provider", "Provider")
                        .WithMany()
                        .HasForeignKey("ProviderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_client_profiles_providers");

                    b.Navigation("ApiCredential");

                    b.Navigation("Model");

                    b.Navigation("Provider");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.LLM.Model", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.LLM.Provider", "Provider")
                        .WithMany("Models")
                        .HasForeignKey("ProviderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_models_providers");

                    b.Navigation("Provider");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.PersonaDream", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "Persona")
                        .WithMany()
                        .HasForeignKey("PersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_persona_dreams_persona");

                    b.Navigation("Persona");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.PersonaEvent", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "Persona")
                        .WithMany()
                        .HasForeignKey("PersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_persona_events_persona");

                    b.HasOne("Cognition.Data.Relational.Modules.Personas.PersonaEventType", "Type")
                        .WithMany()
                        .HasForeignKey("TypeId")
                        .HasConstraintName("fk_persona_events_type");

                    b.Navigation("Persona");

                    b.Navigation("Type");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.PersonaLink", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "FromPersona")
                        .WithMany("OutboundLinks")
                        .HasForeignKey("FromPersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_persona_links_from");

                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "ToPersona")
                        .WithMany("InboundLinks")
                        .HasForeignKey("ToPersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_persona_links_to");

                    b.Navigation("FromPersona");

                    b.Navigation("ToPersona");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.PersonaMemory", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "Persona")
                        .WithMany()
                        .HasForeignKey("PersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_persona_memories_persona");

                    b.HasOne("Cognition.Data.Relational.Modules.Personas.PersonaMemoryType", "Type")
                        .WithMany()
                        .HasForeignKey("TypeId")
                        .HasConstraintName("fk_persona_memories_type");

                    b.Navigation("Persona");

                    b.Navigation("Type");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.PersonaPersonas", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "FromPersona")
                        .WithMany()
                        .HasForeignKey("FromPersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_persona_personas_from");

                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "ToPersona")
                        .WithMany()
                        .HasForeignKey("ToPersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_persona_personas_to");

                    b.Navigation("FromPersona");

                    b.Navigation("ToPersona");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Questions.Question", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Questions.QuestionCategory", "Category")
                        .WithMany()
                        .HasForeignKey("CategoryId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_questions_categories");

                    b.Navigation("Category");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Tools.Tool", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.LLM.ClientProfile", "ClientProfile")
                        .WithMany()
                        .HasForeignKey("ClientProfileId")
                        .HasConstraintName("fk_tools_client_profiles");

                    b.Navigation("ClientProfile");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Tools.ToolExecutionLog", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Agents.Agent", "Agent")
                        .WithMany()
                        .HasForeignKey("AgentId");

                    b.HasOne("Cognition.Data.Relational.Modules.Tools.Tool", "Tool")
                        .WithMany()
                        .HasForeignKey("ToolId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_tool_execution_logs_tools");

                    b.Navigation("Agent");

                    b.Navigation("Tool");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Tools.ToolParameter", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Tools.Tool", "Tool")
                        .WithMany("Parameters")
                        .HasForeignKey("ToolId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_tool_parameters_tools");

                    b.Navigation("Tool");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Tools.ToolProviderSupport", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.LLM.Model", "Model")
                        .WithMany()
                        .HasForeignKey("ModelId")
                        .HasConstraintName("fk_tool_provider_supports_models");

                    b.HasOne("Cognition.Data.Relational.Modules.LLM.Provider", "Provider")
                        .WithMany()
                        .HasForeignKey("ProviderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_tool_provider_supports_providers");

                    b.HasOne("Cognition.Data.Relational.Modules.Tools.Tool", "Tool")
                        .WithMany()
                        .HasForeignKey("ToolId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_tool_provider_supports_tools");

                    b.Navigation("Model");

                    b.Navigation("Provider");

                    b.Navigation("Tool");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Users.RefreshToken", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Users.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_refresh_tokens_users");

                    b.Navigation("User");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Users.User", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "PrimaryPersona")
                        .WithMany()
                        .HasForeignKey("PrimaryPersonaId")
                        .HasConstraintName("fk_users_primary_persona");

                    b.Navigation("PrimaryPersona");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Users.UserPersonas", b =>
                {
                    b.HasOne("Cognition.Data.Relational.Modules.Personas.Persona", "Persona")
                        .WithMany()
                        .HasForeignKey("PersonaId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_user_personas_personas");

                    b.HasOne("Cognition.Data.Relational.Modules.Users.User", "User")
                        .WithMany("UserPersonas")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired()
                        .HasConstraintName("fk_user_personas_users");

                    b.Navigation("Persona");

                    b.Navigation("User");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Agents.Agent", b =>
                {
                    b.Navigation("ToolBindings");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.Conversation", b =>
                {
                    b.Navigation("Messages");

                    b.Navigation("Participants");

                    b.Navigation("Summaries");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Conversations.ConversationPlan", b =>
                {
                    b.Navigation("Tasks");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.DraftSegment", b =>
                {
                    b.Navigation("Versions");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.FictionProject", b =>
                {
                    b.Navigation("GlossaryTerms");

                    b.Navigation("PlotArcs");

                    b.Navigation("StyleGuides");

                    b.Navigation("WorldAssets");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.OutlineNode", b =>
                {
                    b.Navigation("Children");

                    b.Navigation("Versions");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.PlotArc", b =>
                {
                    b.Navigation("OutlineNodes");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.TimelineEvent", b =>
                {
                    b.Navigation("Assets");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Fiction.WorldAsset", b =>
                {
                    b.Navigation("Versions");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Instructions.Instruction", b =>
                {
                    b.Navigation("InstructionSetItems");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Instructions.InstructionSet", b =>
                {
                    b.Navigation("Items");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Knowledge.KnowledgeItem", b =>
                {
                    b.Navigation("Embeddings");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.LLM.Provider", b =>
                {
                    b.Navigation("Models");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Personas.Persona", b =>
                {
                    b.Navigation("InboundLinks");

                    b.Navigation("OutboundLinks");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Tools.Tool", b =>
                {
                    b.Navigation("Parameters");
                });

            modelBuilder.Entity("Cognition.Data.Relational.Modules.Users.User", b =>
                {
                    b.Navigation("UserPersonas");
                });
#pragma warning restore 612, 618
        }
    }
}
